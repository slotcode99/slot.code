<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Slot Machine</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background-color: #cccccc;
            color: #000;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        h1 {
            background-color: #4CAF50;
            color: white;
            padding: 20px 0;
            margin: 0;
        }
        #slot-machine {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-gap: 5px;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
            width: 330px;
            border: 10px solid #555;
            border-radius: 20px;
            background-color: #222;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .slot {
            width: 100px;
            height: 100px;
            border: 2px solid #444;
            border-radius: 10px;
            background-size: cover;
            transition: background-image 0.05s ease; /* Brža rotacija slika */
        }
        .slot.win {
            animation: blink 0.5s alternate 3;
        }
        @keyframes blink {
            from { border-color: #444; }
            to { border-color: #FFD700; }
        }
        #controls {
            margin: 20px;
        }
        #info {
            display: flex;
            justify-content: center;
            margin: 20px;
            flex-direction: column;
        }
        #info-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        #info-box {
            background-color: #bdbdbd;
            border: 2px solid #555;
            border-radius: 10px;
            padding: 10px;
            margin: 0 10px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        #credits, #elixirs {
            font-size: 24px;
        }
        #bet {
            padding: 10px;
            font-size: 16px;
            width: 250px;
            border: none;
            border-radius: 5px;
            margin-top: 10px;
            background-color:#a7a8a7;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        #notification {
            margin: 20px;
            font-size: 18px;
            color: #FFD700;
        }
        #notification-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        #notification-box {
            width: 100px;
            height: 100px;
            border: 2px solid #444;
            border-radius: 10px;
            background-color: #a3a3a3;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #shop-modal {
            display: none;
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
        }
        #shop-content {
            background: #fff;
            color: #000;
            padding: 20px;
            border-radius: 10px;
            width: 300px;
            text-align: center;
        }
        #shop-content input {
            padding: 10px;
            margin: 10px 0;
            width: calc(100% - 22px);
        }
        #shop-content button {
            margin: 10px 5px;
        }
        .background-option {
            display: inline-block;
            width: 80px;
            height: 80px;
            margin: 10px;
            border: 2px solid #444;
            border-radius: 10px;
            cursor: pointer;
            position: relative;
        }
        .background-option span {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-weight: bold;
            font-size: 14px;
        }
        .background-option.black { background-color: #333; }
        .background-option.beach { background-image: url('beach.jpg'); background-size: cover; }
        .background-option.red { background-color: #8B0000; }
        .owned span { color: green; }
        @media (max-width: 600px) {
            #slot-machine {
                width: 100%;
                grid-template-columns: repeat(3, 1fr);
                grid-gap: 2px;
            }
            #credits, #elixirs {
                font-size: 18px;
            }
            #bet {
                width: 100%;
                font-size: 14px;
            }
            #shop-content {
                width: 90%;
            }
            button {
                font-size: 14px;
            }
            #notification-box {
                width: 80px;
                height: 80px;
                background-color: #a3a3a3;
            }
        }
    </style>
</head>
<body>
    <h1>Slot Machine</h1>

    <div id="info-buttons">
        <button onclick="openShop()">Shop</button>
    </div>

    <div id="info">
        <div id="info-box">
            <div id="credits">Your Credits: 100</div>
            <div id="elixirs">Elixirs: 0</div>
        </div>
    </div>
    
    <div id="slot-machine">
        <div class="slot" id="slot1"></div>
        <div class="slot" id="slot2"></div>
        <div class="slot" id="slot3"></div>
        <div class="slot" id="slot4"></div>
        <div class="slot" id="slot5"></div>
        <div class="slot" id="slot6"></div>
        <div class="slot" id="slot7"></div>
        <div class="slot" id="slot8"></div>
        <div class="slot" id="slot9"></div>
    </div>
    
    <div id="notification-container">
        <div id="notification-box"></div>
    </div>
    
    <div id="controls">
        <input type="number" id="bet" placeholder="Enter credits (max 15,000,000)" min="1" max="15000000">
        <button onclick="spin()">Bet</button> <!-- Promenjen tekst dugmeta -->
    </div>
    
    <div id="shop-modal">
        <div id="shop-content">
            <h2>Shop</h2>
            <p>50 credits = 5 elixirs</p>
            <input type="number" id="credits-to-elixirs" placeholder="Enter credits" min="50">
            <button onclick="buyElixirs()">Submit</button>
            <button onclick="closeShop()">Close</button>
            <div>
                <h3>Backgrounds</h3>
                <div class="background-option black" onclick="buyOrEquipBackground('black')">
                    <span id="black-text">100 credits</span>
                </div>
                <div class="background-option beach" onclick="buyOrEquipBackground('beach')">
                    <span id="beach-text">500 elixirs</span>
                </div>
                <div class="background-option red" onclick="buyOrEquipBackground('red')">
                    <span id="red-text">1000 elixirs</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let credits = 100;
        let elixirs = 0;
        const maxBet = 15000000; // Povećano maksimalno betovanje
        const images = ["majmun.png", "jabuka.png", "banana.png", "lubenica.png"];
        const slots = Array.from(document.querySelectorAll('.slot'));
        const creditsDisplay = document.getElementById('credits');
        const elixirsDisplay = document.getElementById('elixirs');
        const notificationBox = document.getElementById('notification-box');
        const shopModal = document.getElementById('shop-modal');
        const blackText = document.getElementById('black-text');
        const beachText = document.getElementById('beach-text');
        const redText = document.getElementById('red-text');

        const backgroundPrices = {
            black: 100,
            beach: 500,
            red: 1000
        };
        let ownedBackgrounds = [];
        const currentBackground = localStorage.getItem('currentBackground');

        if (currentBackground) {
            document.body.style.backgroundImage = currentBackground === 'black' ? '' : `url('${currentBackground}.jpg')`;
            document.body.style.backgroundColor = currentBackground === 'black' ? '#333' : '';
        }

        function saveData() {
            localStorage.setItem('credits', credits);
            localStorage.setItem('elixirs', elixirs);
            localStorage.setItem('ownedBackgrounds', JSON.stringify(ownedBackgrounds));
        }

        function loadData() {
            const savedCredits = localStorage.getItem('credits');
            const savedElixirs = localStorage.getItem('elixirs');
            const savedBackgrounds = localStorage.getItem('ownedBackgrounds');

            if (savedCredits !== null) credits = parseInt(savedCredits, 10);
            if (savedElixirs !== null) elixirs = parseInt(savedElixirs, 10);
            if (savedBackgrounds !== null) ownedBackgrounds = JSON.parse(savedBackgrounds);

            updateDisplay();
        }

        function updateDisplay() {
            creditsDisplay.textContent = `Your Credits: ${credits}`;
            elixirsDisplay.textContent = `Elixirs: ${elixirs}`;
            updateBackgroundText();
        }

        function spin() {
            const betInput = document.getElementById('bet');
            let bet = parseInt(betInput.value, 10);
            if (isNaN(bet) || bet < 1 || bet > maxBet) {
                alert(`Please enter a valid bet amount between 1 and ${maxBet}`);
                return;
            }
            if (bet > credits) {
                alert("You don't have enough credits");
                return;
            }

            // Animacija slot mašine
            let animationInterval = setInterval(() => {
                slots.forEach(slot => {
                    const randomImage = images[Math.floor(Math.random() * images.length)];
                    slot.style.backgroundImage = `url('${randomImage}')`;
                });
            }, 50);

            setTimeout(() => {
                clearInterval(animationInterval);

                slots.forEach(slot => {
                    const randomImage = images[Math.floor(Math.random() * images.length)];
                    slot.style.backgroundImage = `url('${randomImage}')`;
                });

                checkWin(bet);
            }, 500);
        }

        function checkWin(bet) {
            const firstImage = slots[0].style.backgroundImage;
            const allMatch = slots.every(slot => slot.style.backgroundImage === firstImage);

            if (allMatch) {
                const prize = bet * 2;
                credits += prize;
                notificationBox.textContent = `You win ${prize} credits!`;
                notificationBox.style.backgroundColor = 'green';
            } else {
                const winChance = Math.random();
                if (winChance < 0.4) { // Promenjen procenat šanse za pobedu
                    const prize = bet * 2;
                    credits += prize;
                    notificationBox.textContent = `You win ${prize} credits!`;
                    notificationBox.style.backgroundColor = 'green';
                } else {
                    credits -= bet;
                    notificationBox.textContent = 'You lose!';
                    notificationBox.style.backgroundColor = 'red';
                }
            }

            saveData();
            updateDisplay();
        }

        function openShop() {
            shopModal.style.display = 'flex';
        }

        function closeShop() {
            shopModal.style.display = 'none';
        }

        function buyElixirs() {
            const creditsToElixirs = document.getElementById('credits-to-elixirs');
            const creditsSpent = parseInt(creditsToElixirs.value, 10);

            if (isNaN(creditsSpent) || creditsSpent < 50) {
                alert('You need to spend at least 50 credits');
                return;
            }

            if (creditsSpent > credits) {
                alert("You don't have enough credits");
                return;
            }

            const elixirsGained = Math.floor(creditsSpent / 10);
            credits -= creditsSpent;
            elixirs += elixirsGained;

            saveData();
            updateDisplay();
        }

        function buyOrEquipBackground(type) {
            if (ownedBackgrounds.includes(type)) {
                equipBackground(type);
            } else {
                const cost = backgroundPrices[type];
                const currency = type === 'black' ? 'credits' : 'elixirs';
                if (currency === 'credits' && credits >= cost) {
                    credits -= cost;
                    ownedBackgrounds.push(type);
                    equipBackground(type);
                } else if (currency === 'elixirs' && elixirs >= cost) {
                    elixirs -= cost;
                    ownedBackgrounds.push(type);
                    equipBackground(type);
                } else {
                    alert(`You don't have enough ${currency} to buy this background`);
                }
                saveData();
                updateDisplay();
            }
        }

        function equipBackground(type) {
            if (type === 'black') {
                document.body.style.backgroundColor = '#333';
                document.body.style.backgroundImage = '';
            } else {
                document.body.style.backgroundImage = `url('${type}.jpg')`;
                document.body.style.backgroundColor = '';
            }
            localStorage.setItem('currentBackground', type);
            updateBackgroundText();
        }

        function updateBackgroundText() {
            blackText.textContent = ownedBackgrounds.includes('black') ? 'Owned' : '100 credits';
            beachText.textContent = ownedBackgrounds.includes('beach') ? 'Owned' : '500 elixirs';
            redText.textContent = ownedBackgrounds.includes('red') ? 'Owned' : '1000 elixirs';
        }

        loadData(); // Učitavanje podataka prilikom učitavanja stranice
    </script>
</body>
</html>
