<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Slot Mašina</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background-color: #cccccc;
            color: #000;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        h1 {
            background-color: #4CAF50;
            color: white;
            padding: 20px 0;
            margin: 0;
        }
        #slot-machine {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-gap: 5px;
            justify-content: center;
            align-items: center;
            margin: 20px auto;
            width: 330px;
            border: 10px solid #555;
            border-radius: 20px;
            background-color: #222;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .slot {
            width: 100px;
            height: 100px;
            border: 2px solid #444;
            border-radius: 10px;
            background-size: cover;
            transition: background-image 0.05s ease; /* Brža rotacija slika */
        }
        .slot.win {
            animation: blink 0.5s alternate 3;
        }
        @keyframes blink {
            from { border-color: #444; }
            to { border-color: #FFD700; }
        }
        #controls {
            margin: 20px;
        }
        #info {
            display: flex;
            justify-content: center;
            margin: 20px;
            flex-direction: column;
        }
        #info-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        #info-box {
            background-color: #bdbdbd;
            border: 2px solid #555;
            border-radius: 10px;
            padding: 10px;
            margin: 0 10px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        #credits, #elixirs {
            font-size: 24px;
        }
        #bet {
            padding: 10px;
            font-size: 16px;
            width: 250px;
            border: none;
            border-radius: 5px;
            margin-top: 10px;
            background-color:#a7a8a7;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        #notification {
            margin: 20px;
            font-size: 18px;
            color: #FFD700;
        }
        #notification-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        #notification-box {
            width: 100px;
            height: 100px;
            border: 2px solid #444;
            border-radius: 10px;
            background-color: #a3a3a3;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #shop-modal {
            display: none;
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
        }
        #shop-content {
            background: #fff;
            color: #000;
            padding: 20px;
            border-radius: 10px;
            width: 300px;
            text-align: center;
        }
        #shop-content input {
            padding: 10px;
            margin: 10px 0;
            width: calc(100% - 22px);
        }
        #shop-content button {
            margin: 10px 5px;
        }
        .background-option {
            display: inline-block;
            width: 80px;
            height: 80px;
            margin: 10px;
            border: 2px solid #444;
            border-radius: 10px;
            cursor: pointer;
            position: relative;
        }
        .background-option span {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-weight: bold;
            font-size: 14px;
        }
        .background-option.black { background-color: #333; }
        .background-option.beach { background-image: url('beach.jpg'); background-size: cover; }
        .background-option.red { background-color: #8B0000; }
        .owned span { color: green; }
        @media (max-width: 600px) {
            #slot-machine {
                width: 100%;
                grid-template-columns: repeat(3, 1fr);
                grid-gap: 2px;
            }
            #credits, #elixirs {
                font-size: 18px;
            }
            #bet {
                width: 100%;
                font-size: 14px;
            }
            #shop-content {
                width: 90%;
            }
            button {
                font-size: 14px;
            }
            #notification-box {
                width: 80px;
                height: 80px;
                background-color: #a3a3a3;
            }
        }
    </style>
</head>
<body>
    <h1>Slot Mašina</h1>

    <div id="info-buttons">
        <button onclick="openShop()">Shop</button>
    </div>

    <div id="info">
        <div id="info-box">
            <div id="credits">Your Credits: 100</div>
            <div id="elixirs">Elixirs: 0</div>
        </div>
    </div>
    
    <div id="slot-machine">
        <div class="slot" id="slot1"></div>
        <div class="slot" id="slot2"></div>
        <div class="slot" id="slot3"></div>
        <div class="slot" id="slot4"></div>
        <div class="slot" id="slot5"></div>
        <div class="slot" id="slot6"></div>
        <div class="slot" id="slot7"></div>
        <div class="slot" id="slot8"></div>
        <div class="slot" id="slot9"></div>
    </div>
    
    <div id="notification-container">
        <div id="notification-box"></div>
    </div>
    
    <div id="controls">
        <input type="number" id="bet" placeholder="Enter credits" min="1">
        <button onclick="spin()">Bet</button>
    </div>
    
    <div id="shop-modal">
        <div id="shop-content">
            <h2>Shop</h2>
            <p>50 credits = 5 elixirs</p>
            <input type="number" id="credits-to-elixirs" placeholder="Enter credits" min="50">
            <button onclick="buyElixirs()">Submit</button>
            <button onclick="closeShop()">Close</button>
            <div>
                <h3>Backgrounds</h3>
                <div class="background-option black" onclick="buyOrEquipBackground('black')">
                    <span id="black-text">100 credits</span>
                </div>
                <div class="background-option beach" onclick="buyOrEquipBackground('beach')">
                    <span id="beach-text">500 elixirs</span>
                </div>
                <div class="background-option red" onclick="buyOrEquipBackground('red')">
                    <span id="red-text">1000 elixirs</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let credits = 100;
        let elixirs = 0;
        const images = ["majmun.png", "jabuka.png", "banana.png", "lubenica.png"];
        const backgrounds = {
            black: "#333",
            beach: "url('beach.jpg')",
            red: "#8B0000"
        };
        let ownedBackgrounds = {
            black: false,
            beach: false,
            red: false
        };
        let currentBackground = 'white'; // Default background color

        function formatNumber(number) {
            return number.toLocaleString('hr-HR'); // Formatiranje broja sa tačkama
        }

        function updateCredits(amount) {
            credits += amount;
            document.getElementById('credits').innerText = `Your Credits: ${formatNumber(credits)}`;
        }

        function updateElixirs(amount) {
            elixirs += amount;
            document.getElementById('elixirs').innerText = `Elixirs: ${elixirs}`;
        }

        function getRandomImage() {
            const randomIndex = Math.floor(Math.random() * images.length);
            return images[randomIndex];
        }

        function getRandomOutcome() {
            const randomValue = Math.random();
            return randomValue < 0.45;
        }

        function checkWinCondition() {
            const slots = [
                document.getElementById('slot1').style.backgroundImage,
                document.getElementById('slot2').style.backgroundImage,
                document.getElementById('slot3').style.backgroundImage,
                document.getElementById('slot4').style.backgroundImage,
                document.getElementById('slot5').style.backgroundImage,
                document.getElementById('slot6').style.backgroundImage,
                document.getElementById('slot7').style.backgroundImage,
                document.getElementById('slot8').style.backgroundImage,
                document.getElementById('slot9').style.backgroundImage,
            ];

            const winCombinations = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // Horizontalno
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // Vertikalno
                [0, 4, 8], [2, 4, 6]             // Dijagonalno
            ];

            for (const combination of winCombinations) {
                const [a, b, c] = combination;
                if (slots[a] === slots[b] && slots[b] === slots[c]) {
                    return {win: true, winningSlots: combination};
                }
            }

            return {win: false};
        }

        function displayNotification(message) {
            const notificationBox = document.getElementById('notification-box');
            notificationBox.innerText = message;
            setTimeout(() => {
                notificationBox.innerText = '';
            }, 3000);
        }

        function spin() {
            const bet = parseInt(document.getElementById('bet').value);

            if (isNaN(bet) || bet < 1) {
                displayNotification('Unesite validan iznos kredita.');
                return;
            }

            if (bet > credits) {
                displayNotification('Nema dovoljno kredita.');
                return;
            }

            updateCredits(-bet);

            let spins = 20; // Povećano brzinu rotacije
            let interval = setInterval(() => {
                for (let i = 1; i <= 9; i++) {
                    document.getElementById(`slot${i}`).style.backgroundImage = `url(${getRandomImage()})`;
                }
                spins--;
                if (spins <= 0) {
                    clearInterval(interval);

                    for (let i = 1; i <= 9; i++) {
                        document.getElementById(`slot${i}`).style.backgroundImage = `url(${getRandomImage()})`;
                    }

                    const result = getRandomOutcome() ? checkWinCondition() : {win: false};
                    if (result.win) {
                        const winnings = bet * 50;
                        updateCredits(winnings);
                        result.winningSlots.forEach(index => document.getElementById(`slot${index + 1}`).classList.add('win'));
                        displayNotification(`Pobeda! Osvojili ste ${formatNumber(winnings)} kredita!`);
                        setTimeout(() => {
                            result.winningSlots.forEach(index => document.getElementById(`slot${index + 1}`).classList.remove('win'));
                        }, 1500);
                    } else {
                        displayNotification('Nažalost, izgubili ste.');
                    }
                }
            }, 100); // Brža rotacija
        }

        function openShop() {
            document.getElementById('shop-modal').style.display = 'flex';
        }

        function closeShop() {
            document.getElementById('shop-modal').style.display = 'none';
        }

        function buyElixirs() {
            const creditsToElixirs = parseInt(document.getElementById('credits-to-elixirs').value);
            if (isNaN(creditsToElixirs) || creditsToElixirs % 50 !== 0 || creditsToElixirs < 50) {
                displayNotification('Unesite validan iznos kredita (mora biti množenje od 50).');
                return;
            }

            const elixirsBought = (creditsToElixirs / 50) * 5;
            if (creditsToElixirs > credits) {
                displayNotification('Nema dovoljno kredita.');
                return;
            }

            updateCredits(-creditsToElixirs);
            updateElixirs(elixirsBought);
            displayNotification(`Kupili ste ${elixirsBought} eliksira.`);
            closeShop();
        }

        function buyOrEquipBackground(type) {
            if (ownedBackgrounds[type]) {
                setBackground(type);
                return;
            }

            const costs = { black: 100, beach: 500, red: 1000 };
            const costType = type === "black" ? "credits" : "elixirs";
            const cost = costs[type];

            if ((costType === "credits" && credits >= cost) || (costType === "elixirs" && elixirs >= cost)) {
                if (costType === "credits") {
                    updateCredits(-cost);
                } else {
                    updateElixirs(-cost);
                }
                ownedBackgrounds[type] = true;
                document.getElementById(`${type}-text`).innerText = "Owned";
                document.getElementById(`${type}-text`).style.color = "green";
                setBackground(type);
            } else {
                displayNotification("Nema dovoljno " + costType);
            }
        }

        function setBackground(type) {
            document.body.style.background = backgrounds[type];
            currentBackground = type;
            document.body.style.color = (type === 'black' || type === 'beach') ? '#000' : '#000';
        }

        for (let i = 1; i <= 9; i++) {
            document.getElementById(`slot${i}`).style.backgroundImage = `url(${images[i % images.length]})`;
        }
    </script>
</body>
</html>
